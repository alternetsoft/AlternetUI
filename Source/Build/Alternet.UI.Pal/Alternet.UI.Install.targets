<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <!-- 
		DownloadAndExtractWxWidgetsBin
		DownloadAndExtractWxWidgets		
		CleanWxWidgetsBuildDirectory
		
		BuildWxWidgets
		BuildWxWidgetsWithoutDownload /p:DebugOnlyWxWidgetsBuild=true
		BuildWxWidgetsWithoutDownload /p:DebugOnlyWxWidgetsBuild=true /p:x64Only=true
		BuildWxWidgetsWithoutDownload
		BuildWxWidgetsWithoutDownload /p:ReleaseOnlyWxWidgetsBuild=true
		BuildWxWidgets /p:ReleaseOnlyWxWidgetsBuild=true
		
	-->
    <!-- ========================================== -->
	<Target Name="ClearProjectBin">
		<Message Text="--------------------------------------------------------" Importance="high" />
		<Message Text="Exec ClearProjectBin" Importance="high" />
		<ItemGroup>
			<CsProjFiles Include="$(RootDirectoryPath)\**\*.csproj"/>
		</ItemGroup>
		<ItemGroup>
			<CsProjFolders Include="@(CsProjFiles->'%(RelativeDir)/bin')"/>
			<CsProjFolders Include="@(CsProjFiles->'%(RelativeDir)/obj')"/>
		</ItemGroup>
		<PropertyGroup>
			<RmDirCommand Condition="$([MSBuild]::IsOsPlatform('Windows'))">rmdir /s /q</RmDirCommand>
			<RmDirCommand Condition="$([MSBuild]::IsOsPlatform('Linux'))">rm -rf</RmDirCommand>
			<RmDirCommand Condition="$([MSBuild]::IsOsPlatform('OSX'))">rm -r</RmDirCommand>
		</PropertyGroup>
		<Message Text="Clean: %(CsProjFolders.FullPath)" Importance="high"
		Condition="Exists(%(CsProjFolders.FullPath))"/>

		<Exec 
			WorkingDirectory="$(RootDirectoryPath)" 
			Command="$(RmDirCommand) &quot;%(CsProjFolders.FullPath)&quot;" Condition="Exists(%(CsProjFolders.FullPath))"/>
		<Exec 
			WorkingDirectory="$(RootDirectoryPath)" 
			Command="$(RmDirCommand) &quot;%(CsProjFolders.FullPath)&quot;" Condition="Exists(%(CsProjFolders.FullPath))"/>
	</Target>
    <!-- ========================================== -->
	<Target Name="BuildControlsSample">
		<Exec 
			WorkingDirectory="$(RootDirectoryPath)/Source/Samples/ControlsSample" 
			Command="$(DotNetBuildCmd)" />
	</Target>		
    <!-- ========================================== -->
	<Target Name="RunControlsSample">
		<Exec 
			WorkingDirectory="$(RootDirectoryPath)/Source/Samples/ControlsSample" 
			Command="$(DotNetRunCmd)" />
	</Target>
    <!-- ========================================== -->
	<Target Name="RunControlsSampleAsync">
        <Exec
            WorkingDirectory="$(RootDirectoryPath)/Source/Tools/Alternet.UI.RunCmd"
            Command="dotnet run -- -r=runControlsSample" />
	</Target>
    <!-- ========================================== -->
	<Target Name="WaitEnter">
        <Exec
            WorkingDirectory="$(RootDirectoryPath)/Source/Tools/Alternet.UI.RunCmd"
            Command="dotnet run -- -r=waitEnter" />
	</Target>
    <!-- ========================================== -->
	<Target Name="CopyArtefacts">
		<!-- <RemoveDir Directories="$(UI_PAL_ARTIFACTS_PATH)" Condition="Exists($(UI_PAL_ARTIFACTS_PATH))"/> -->
		<!-- <RemoveDir Directories="$(UI_PAL_B)" Condition="Exists($(UI_PAL_B))"/> -->
		<MakeDir Directories="$(UI_PAL_ARTIFACTS_PATH)" Condition="!Exists($(UI_PAL_ARTIFACTS_PATH))"/>	
		<MakeDir Directories="$(UI_PAL_B)" Condition="!Exists($(UI_PAL_B))"/>	
		<ItemGroup>
					   <MySourceFiles Include="$(UI_PAL_BIN)\**\*.*"/>
		</ItemGroup>
		<Copy
			SourceFiles="@(MySourceFilesRelease)"
			DestinationFolder="$(UI_PAL_ARTIFACTS_PATH)\%(RecursiveDir)"	/>
		<Copy
			SourceFiles="@(MySourceFiles)"
			DestinationFolder="$(UI_PAL_B)\%(RecursiveDir)"	/>
	</Target>
    <!-- ========================================== -->
    <Target Name="BuildAlternetUIBuildTasks">
		<Message Text="--------------------------------------------------------" Importance="high" />
		<Message Text="Exec Build Alternet.UI.Build.Tasks" Importance="high" />
		<Exec 
			WorkingDirectory="$(RootDirectoryPath)/Source/Alternet.UI.Build.Tasks" 
			Command="$(DotNetBuildDebugCmd)" />
		<Exec 
			WorkingDirectory="$(RootDirectoryPath)/Source/Alternet.UI.Build.Tasks" 
			Command="$(DotNetBuildReleaseCmd)" />
	</Target>
    <!-- ========================================== -->
    <Target Name="BuildAlternetUIBuildTasksApiInfoCollector">
		<Message Text="--------------------------------------------------------" Importance="high" />
		<Message Text="Exec Build Alternet.UI.Build.Tasks.ApiInfoCollector" Importance="high" />
		<Exec 
			WorkingDirectory="$(RootDirectoryPath)/Source/Alternet.UI.Build.Tasks/Alternet.UI.Build.Tasks.ApiInfoCollector" 
			Command="$(DotNetBuildDebugCmd)" />
		<Exec 
			WorkingDirectory="$(RootDirectoryPath)/Source/Alternet.UI.Build.Tasks/Alternet.UI.Build.Tasks.ApiInfoCollector" 
			Command="$(DotNetBuildReleaseCmd)" />
	</Target>
    <!-- ========================================== -->
    <Target Name="InstallAlternetUI">
		<Message Text="========================" Importance="high" />
		<Message Text="Alternet.UI Installation started" Importance="high" />
		<Exec 
			WorkingDirectory="$(RootDirectoryPath)" 
			Command="find . -name &quot;*.sh&quot; -exec chmod +x {} \;" 
			Condition="$([MSBuild]::IsOsPlatform('Linux'))" />
			
		<CallTarget Targets="ClearProjectBin"/>
		<Message Text="--------------------------------------------------------" Importance="high" />
		<Message Text="Exec DownloadAndExtract WxWidgets Bin" Importance="high" />
		<CallTarget Targets="DownloadAndExtractWxWidgetsBin" Condition="!Exists($(WxWidgetsDirectory))"/>
		<Message Text="--------------------------------------------------------" Importance="high" />
		<Message Text="Exec Build WxWidgets Linux" Importance="high" />
        <CallTarget Targets="BuildWxWidgets_Linux" Condition="!Exists($(WxWidgetsGtkBuildDirectory))"/>
		<Message Text="--------------------------------------------------------" Importance="high" />
		<Message Text="Exec Build WxWidgets MacOS" Importance="high" />
        <CallTarget Targets="BuildWxWidgets_MacOS" Condition="!Exists($(WxWidgetsMacOSBuildDirectory))"/>
    <!-- ========================================== -->
		<Message Text="--------------------------------------------------------" Importance="high" />
		<Message Text="Exec Build Alternet.UI.Pal" Importance="high" />
		<CallTarget Targets="BuildNative_Windows"/>
		<CallTarget Targets="BuildNative_Unix"/>
	<!-- ========================================== -->
		<CallTarget Targets="BuildAlternetUIBuildTasksApiInfoCollector"/>
	<!-- ========================================== -->
		<Message Text="--------------------------------------------------------" Importance="high" />
		<Message Text="Exec Build Alternet.UI" Importance="high" />
		<Exec 
			WorkingDirectory="$(RootDirectoryPath)/Source/Alternet.UI" 
			Command="$(DotNetBuildDebugCmd)" />
		<Exec 
			WorkingDirectory="$(RootDirectoryPath)/Source/Alternet.UI" 
			Command="$(DotNetBuildReleaseCmd)" />
    <!-- ========================================== -->
		<CallTarget Targets="BuildAlternetUIBuildTasks"/>
    <!-- ========================================== -->
		<Message Text="--------------------------------------------------------" Importance="high" />
		<Message Text="Exec CopyArtefacts" Importance="high" />
		<CallTarget Targets="CopyArtefacts"/>
    <!-- ========================================== -->
		<Message Text="--------------------------------------------------------" Importance="high" />
		<Message Text="Exec Build ControlsSample" Importance="high" />
		<CallTarget Targets="BuildControlsSample"/>
		<CallTarget Targets="RunControlsSample"/>		
		<Message Text="Alternet.UI Installation done." Importance="high" />
  		<Message Text="========================" Importance="high" />
	<!-- ========================================== -->
    </Target>
    <!-- ========================================== -->
    <!-- ========================================== -->
</Project>

<!-- 

-->
